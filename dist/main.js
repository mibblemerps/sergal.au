(()=>{"use strict";class e{constructor(e,t,s,n,r,a,i,l){this.name=e,this.icon=t,this.description=s,this.price=n,this.nextPurchasePriceMultiplier=r,this.merpsPerSecond=a??0,this.merpsMultiplier=i??0,this.callback=l,this.owned=0}add(e=!1){e||(this.price=Math.round(this.price*this.nextPurchasePriceMultiplier)),this.owned++,this.callback&&this.callback()}get canOnlyOwnOne(){return!this.nextPurchasePriceMultiplier}}class t extends e{constructor(e,t,s,n,r,a,i){super(e,t,s,n,r,a,i,null),this.callback=this._callback}async _callback(){const e=document.createElement("div");e.classList.add("sergal"),e.dataset.shopId="0",e.dataset.lastMerp=(new Date).getTime().toString();const t=document.createElement("img");t.src="sergal-1.png",t.alt="Sergal",t.draggable=!1,e.appendChild(t),Game.sergalContainer.appendChild(e),Game.sergals.push(e),e.merpDown=(e,s)=>{e?.preventDefault(),t.src="sergal-2.png",function(e){const t=document.createElement("audio");t.src="merp.mp3",t.play().catch((()=>{t.remove()})),t.addEventListener("ended",(()=>{t.remove()}))}(),Game.merp(s??this.merpsPerSecond)},e.merpUp=()=>{t.src="sergal-1.png"},e.addEventListener("mousedown",e.merpDown),e.addEventListener("mouseup",e.merpUp),e.addEventListener("mouseleave",e.merpUp),e.addEventListener("touchstart",e.merpDown),e.addEventListener("touchend",e.merpUp),e.addEventListener("touchcancel",e.merpUp),e.addEventListener("contextmenu",(e=>{e.preventDefault()}));let s=new Date;for(await new Promise((e=>setTimeout(e,1e3*Math.random())));;){await new Promise((e=>setTimeout(e,250*Math.random()-125+1e3)));let t=(new Date-s)/1e3;s=new Date;let n=this.merpsPerSecond*Game.merpsMultiplier*t;0!==n&&(e.merpDown(null,n),await new Promise((e=>setTimeout(e,100))),e.merpUp())}}}class s extends e{constructor(e,t,s,n,r){super(e,t,s,n,null,null,r,null)}get canOnlyOwnOne(){return!0}}window.Game={el:null,merps:0,nextSergalCost:100,_merpsLastUpdate:null,_lastUpdateAt:new Date,_lastCanAfford:null,sergalContainer:null,shopContainer:null,merpCountElements:null,mpsElements:null,sergals:[],shop:new class{constructor(){this.items=[]}},setup(){this.el=document.getElementsByTagName("main")[0],this.sergalContainer=Game.el.getElementsByClassName("sergals")[0],this.shopContainer=Game.el.getElementsByClassName("shop")[0],this.merpCountElements=Game.el.querySelectorAll("[data-merp-count]"),this.mpsElements=Game.el.querySelectorAll("[data-mps]");const e=new t("Sergal","merp-icon.png","A sergal :3",150,2,1,0);this.shop.items.push(e),this.shop.items.push(new s("Cheddar Cheese","cheddar.png","Tasty cheddar! It's in the name!",100,1)),this.shop.items.push(new s("Mozzarella Cheese","mozzarella.png","Supposedly healthier for your serg. Makes good cheese pulls.",1e3,1)),this.shop.items.push(new s("Swiss Cheese","swiss.png","Sergs like holes, including those found in swiss cheese!",1e4,1)),this.shop.items.push(new s("Brie Cheese","brie.png","Often enjoyed with crackers.",1e4,1)),this.shop.items.push(new s("Parmesan Cheese","parmesan.png","You wouldn't eat this on it's own but your sergs will!",1e4,1)),this.shop.items.push(new s("Pule Cheese","pule.png","The world's most expensive cheese for your most precious sergos!",1e5,100)),e.add(!0),this.update(),setInterval((()=>{this.update()}),1e3)},merp(e=1){this.merps+=e,this.update()},get merpsPerSecond(){let e=0;for(let t of this.shop.items)e+=t.owned*t.merpsPerSecond*this.merpsMultiplier;return e},get merpsMultiplier(){let e=0;for(let t of this.shop.items)e+=(t.merpsMultiplier??0)*t.owned;return e},update(){const e=this._merpsLastUpdate!==this.merps;for(let e of this.merpCountElements)e.innerText=Math.round(this.merps);for(let e of this.mpsElements)e.innerText=Math.round(this.merpsPerSecond);e&&this.updateShopContainer(),this._merpsLastUpdate=this.merps},updateShopContainer(e=!1){if(!e){let e=[];for(let t of this.shop.items)this.merps>=t.price&&e.push(t);if(this._lastCanAfford&&e.length===this._lastCanAfford.length&&e.every(((e,t)=>e===this._lastCanAfford[t])))return;this._lastCanAfford=e}const t=this.shopContainer.querySelector(".items");t.replaceChildren();for(const e of this.shop.items){if(e.canOnlyOwnOne&&e.owned>0)continue;const s=document.createElement("div");s.classList.add("item");const n=document.createElement("div");n.classList.add("item-count"),e.canOnlyOwnOne||(n.innerText=e.owned),s.appendChild(n);const r=document.createElement("div");r.classList.add("item-name"),r.innerText=e.name,s.appendChild(r);const a=document.createElement("div");a.classList.add("item-buy"),a.innerHTML=` <span class="price"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" fill="#fff">\x3c!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e<path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/></svg> ${e.price} merps</span>`,e.price>this.merps?a.classList.add("item-cannot-afford"):(a.classList.add("item-can-afford"),a.addEventListener("click",(()=>{this.merps<e.price||(this.merps-=e.price,e.add(),this.updateShopContainer(!0))}))),s.appendChild(a),t.appendChild(s)}}},window.addEventListener("load",(()=>{Game.setup()}))})();